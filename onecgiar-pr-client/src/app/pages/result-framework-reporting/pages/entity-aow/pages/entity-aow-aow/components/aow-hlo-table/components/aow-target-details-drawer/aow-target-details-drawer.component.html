<p-drawer
  [(visible)]="entityAowService.showTargetDetailsDrawer"
  [position]="entityAowService.targetDetailsDrawerFullScreen() ? 'full' : 'right'"
  [closable]="false"
  [style]="{ minWidth: '65vw' }">
  <ng-template #header>
    <div class="target-details-drawer-header">
      <div class="target-details-drawer-header_content">
        <p class="target-details-drawer-header_subtitle">
          {{ entityAowService.entityId() }} - {{ entityAowService.entityDetails().name }}
          @if (entityAowService.currentAowSelected()) {
            / {{ entityAowService.currentAowSelected().code }} - {{ entityAowService.currentAowSelected().name }}
          }
        </p>

        <div class="target-details-drawer-header_content_icons">
          <i
            class="pi {{
              entityAowService.targetDetailsDrawerFullScreen()
                ? 'pi-arrow-down-left-and-arrow-up-right-to-center'
                : 'pi-arrow-up-right-and-arrow-down-left-from-center'
            }}"
            style="font-size: 15px; cursor: pointer"
            (click)="entityAowService.targetDetailsDrawerFullScreen.set(!entityAowService.targetDetailsDrawerFullScreen())"></i>
          <i
            class="pi pi-times"
            style="font-size: 16px; cursor: pointer"
            (click)="entityAowService.showTargetDetailsDrawer.set(false); entityAowService.targetDetailsDrawerFullScreen.set(false)"></i>
        </div>
      </div>
      <p class="target-details-drawer-header_title">{{ entityAowService.currentTargetToView()?.result_title }}</p>
      <p class="target-details-drawer-header_desc">{{ entityAowService.currentTargetToView()?.indicators?.[0]?.indicator_description }}</p>
    </div>
  </ng-template>

  <div class="target-details-drawer-content">
    <h3 class="target-details-drawer-content_title">Target details</h3>
    <p class="target-details-drawer-content_desc">See details.</p>

    <p-table [value]="tableData()" [tableStyle]="{ marginTop: '24px' }" styleClass="target-details-table">
      <ng-template #header>
        <tr>
          <th scope="col" class="center-column">
            <div class="header-content">
              <span>Center</span>
              <i class="pi pi-sort-alt"></i>
            </div>
          </th>
          @for (year of years(); track year) {
            <th scope="col" class="year-column">{{ year }}</th>
          }
        </tr>
      </ng-template>
      <ng-template #body let-row>
        <tr>
          <td class="center-cell">
            <div class="center-content">
              <i class="pi pi-building"></i>
              <span>{{ row.center.center_name }}</span>
            </div>
          </td>
          @for (year of years(); track year) {
            <td class="value-cell">{{ getTargetValue(row, year) }}</td>
          }
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td [attr.colspan]="years().length + 1" class="noDataText">No target details available</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</p-drawer>
