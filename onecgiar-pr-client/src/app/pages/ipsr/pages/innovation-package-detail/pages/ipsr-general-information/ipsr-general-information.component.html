<app-ipsr-annual-updating
  *ngIf="this.ipsrGeneralInformationBody.is_replicated"
  [ipsrGeneralInfoBody]="this.ipsrGeneralInformationBody"></app-ipsr-annual-updating>

<app-pr-input
  placeholder="Provide input here..."
  label="Reporting year"
  type="text"
  [required]="false"
  [readOnly]="true"
  [(ngModel)]="this.ipsrGeneralInformationBody.reported_year_id">
</app-pr-input>

<app-pr-textarea
  placeholder="Provide input here..."
  description="Title is autogenerated as per the selected core innovation and its geoscope but is editable."
  label="Title"
  type="text"
  [(ngModel)]="this.ipsrGeneralInformationBody.title"
  [maxWords]="30"
  [rows]="2"
  [autogenerate]="true">
</app-pr-textarea>

@if (this.fieldsManagerSE.isP25()) {
  <app-pr-textarea
    placeholder="Provide input here..."
    label="Description"
    type="text"
    [required]="true"
    [maxWords]="150"
    [description]="descriptionTextInfo()"
    [(ngModel)]="this.ipsrGeneralInformationBody.description">
  </app-pr-textarea>
} @else {
  <app-pr-textarea
    placeholder="Provide input here..."
    label="Description"
    type="text"
    [required]="true"
    [maxWords]="150"
    [(ngModel)]="this.ipsrGeneralInformationBody.description">
  </app-pr-textarea>
}

<app-lead-contact-person-field [body]="this.ipsrGeneralInformationBody"></app-lead-contact-person-field>

@if (this.fieldsManagerSE.isP25()) {
  <h1 class="pr_label">Impact Area scores:</h1>
  <app-alert-status [description]="impactAreaScoresInfo()"> </app-alert-status>
}

<div class="block_container">
  <app-alert-status [description]="genderInformation()"></app-alert-status>

  <div class="radio_grid">
    <app-pr-radio-button
      [options]="this.scoreSE.genderTagScoreList"
      optionLabel="full_name"
      optionValue="id"
      label="Gender equality tag"
      [(ngModel)]="this.ipsrGeneralInformationBody.gender_tag_level_id">
    </app-pr-radio-button>

    @if (this.fieldsManagerSE.isP25()) {
      <div id="gender_tag_alert" [hidden]="this.ipsrGeneralInformationBody.gender_tag_level_id != 3"></div>
    } @else {
      <div *ngIf="this.ipsrGeneralInformationBody.gender_tag_level_id == 3">
        <app-alert-status description="As a score of 2 has been selected, you are required to provide evidence of the Gender equality tag.">
        </app-alert-status>
      </div>
    }
  </div>

  @if (this.ipsrGeneralInformationBody.gender_tag_level_id == 3) {
    <app-pr-radio-button
      [options]="this.getImpactAreasScoresComponents.genderTagScoreList()"
      optionLabel="name"
      optionValue="id"
      fieldRef="[general-info]-gender_impact_area_id"
      [(ngModel)]="this.ipsrGeneralInformationBody.gender_impact_area_id">
    </app-pr-radio-button>
  }

  @if (!this.fieldsManagerSE.isP25()) {
    <div *ngIf="this.ipsrGeneralInformationBody.gender_tag_level_id != null">
      <app-pr-input
        label="Evidence"
        [required]="this.ipsrGeneralInformationBody.gender_tag_level_id == 3"
        placeholder="Link"
        [(ngModel)]="this.ipsrGeneralInformationBody.evidence_gender_tag">
      </app-pr-input>
    </div>
  }
</div>

<div class="block_container">
  <app-alert-status [description]="climateInformation()"></app-alert-status>

  <div class="radio_grid">
    <app-pr-radio-button
      [(ngModel)]="this.ipsrGeneralInformationBody.climate_change_tag_level_id"
      [options]="this.scoreSE.genderTagScoreList"
      optionLabel="full_name"
      optionValue="id"
      label="Climate change tag">
    </app-pr-radio-button>

    @if (this.fieldsManagerSE.isP25()) {
      <div id="climate_change_tag_alert" [hidden]="this.ipsrGeneralInformationBody.climate_change_tag_level_id != 3"></div>
    } @else {
      <div *ngIf="this.ipsrGeneralInformationBody.climate_change_tag_level_id == 3">
        <app-alert-status description="As a score of 2 has been selected, you are required to provide evidence of the climate change tag.">
        </app-alert-status>
      </div>
    }
  </div>

  @if (this.ipsrGeneralInformationBody.climate_change_tag_level_id == 3) {
    <app-pr-radio-button
      [options]="this.getImpactAreasScoresComponents.climateTagScoreList()"
      optionLabel="name"
      optionValue="id"
      fieldRef="[general-info]-climate_impact_area_id"
      [(ngModel)]="this.ipsrGeneralInformationBody.climate_impact_area_id">
    </app-pr-radio-button>
  }

  @if (!this.fieldsManagerSE.isP25()) {
    <div *ngIf="this.ipsrGeneralInformationBody.climate_change_tag_level_id != null">
      <app-pr-input
        label="Evidence"
        [required]="this.ipsrGeneralInformationBody.climate_change_tag_level_id == 3"
        placeholder="Link"
        [(ngModel)]="this.ipsrGeneralInformationBody.evidence_climate_tag">
      </app-pr-input>
    </div>
  }
</div>

<div class="block_container">
  <app-alert-status [description]="nutritionInformation()"></app-alert-status>

  <div class="radio_grid">
    <app-pr-radio-button
      [(ngModel)]="this.ipsrGeneralInformationBody.nutrition_tag_level_id"
      [options]="this.scoreSE.genderTagScoreList"
      optionLabel="full_name"
      optionValue="id"
      label="Nutrition, health and food security tag">
    </app-pr-radio-button>

    @if (this.fieldsManagerSE.isP25()) {
      <div id="nutrition_tag_alert" [hidden]="this.ipsrGeneralInformationBody.nutrition_tag_level_id != 3"></div>
    } @else {
      <div *ngIf="this.ipsrGeneralInformationBody.nutrition_tag_level_id == 3">
        <app-alert-status
          description="As a score of 2 has been selected, you are required to provide evidence of the Nutrition, health and food security tag.">
        </app-alert-status>
      </div>
    }
  </div>

  @if (this.ipsrGeneralInformationBody.nutrition_tag_level_id == 3) {
    <app-pr-radio-button
      [options]="this.getImpactAreasScoresComponents.nutritionTagScoreList()"
      optionLabel="name"
      optionValue="id"
      fieldRef="[general-info]-nutrition_impact_area_id"
      [(ngModel)]="this.ipsrGeneralInformationBody.nutrition_impact_area_id">
    </app-pr-radio-button>
  }

  @if (!this.fieldsManagerSE.isP25()) {
    <div *ngIf="this.ipsrGeneralInformationBody.nutrition_tag_level_id != null">
      <app-pr-input
        label="Evidence"
        [required]="this.ipsrGeneralInformationBody.nutrition_tag_level_id == 3"
        placeholder="Link"
        [(ngModel)]="this.ipsrGeneralInformationBody.evidence_nutrition_tag">
      </app-pr-input>
    </div>
  }
</div>

<div class="block_container">
  <app-alert-status [description]="environmentInformation()"></app-alert-status>

  <div class="radio_grid">
    <app-pr-radio-button
      [(ngModel)]="this.ipsrGeneralInformationBody.environmental_biodiversity_tag_level_id"
      [options]="this.scoreSE.genderTagScoreList"
      optionLabel="full_name"
      optionValue="id"
      label="Environmental health and biodiversity tag">
    </app-pr-radio-button>

    @if (this.fieldsManagerSE.isP25()) {
      <div id="environment_tag_alert" [hidden]="this.ipsrGeneralInformationBody.environmental_biodiversity_tag_level_id != 3"></div>
    } @else {
      <div *ngIf="this.ipsrGeneralInformationBody.environmental_biodiversity_tag_level_id == 3">
        <app-alert-status
          description="As a score of 2 has been selected, you are required to provide evidence of the Environmental health and biodiversity tag.">
        </app-alert-status>
      </div>
    }
  </div>

  @if (this.ipsrGeneralInformationBody.environmental_biodiversity_tag_level_id == 3) {
    <app-pr-radio-button
      [options]="this.getImpactAreasScoresComponents.environmentalBiodiversityTagScoreList()"
      optionLabel="name"
      optionValue="id"
      fieldRef="[general-info]-environmental_biodiversity_impact_area_id"
      [(ngModel)]="this.ipsrGeneralInformationBody.environmental_biodiversity_impact_area_id">
    </app-pr-radio-button>
  }

  @if (!this.fieldsManagerSE.isP25()) {
    <div *ngIf="this.ipsrGeneralInformationBody.environmental_biodiversity_tag_level_id != null">
      <app-pr-input
        label="Evidence"
        [required]="this.ipsrGeneralInformationBody.environmental_biodiversity_tag_level_id == 3"
        placeholder="Link"
        [(ngModel)]="this.ipsrGeneralInformationBody.evidence_environment_tag">
      </app-pr-input>
    </div>
  }
</div>

<div class="block_container">
  <app-alert-status [description]="povertyInformation()"> </app-alert-status>

  <div class="radio_grid">
    <app-pr-radio-button
      [(ngModel)]="this.ipsrGeneralInformationBody.poverty_tag_level_id"
      [options]="this.scoreSE.genderTagScoreList"
      optionLabel="full_name"
      optionValue="id"
      label="Poverty reduction, livelihoods and jobs tag">
    </app-pr-radio-button>

    @if (this.fieldsManagerSE.isP25()) {
      <div id="poverty_tag_alert" [hidden]="this.ipsrGeneralInformationBody.poverty_tag_level_id != 3"></div>
    } @else {
      <div *ngIf="this.ipsrGeneralInformationBody.poverty_tag_level_id == 3">
        <app-alert-status
          description="As a score of 2 has been selected, you are required to provide evidence of the Poverty reduction, livelihoods and jobs tag.">
        </app-alert-status>
      </div>
    }
  </div>

  @if (this.ipsrGeneralInformationBody.poverty_tag_level_id == 3) {
    <app-pr-radio-button
      [options]="this.getImpactAreasScoresComponents.povertyTagScoreList()"
      optionLabel="name"
      optionValue="id"
      fieldRef="[general-info]-poverty_impact_area_id"
      [(ngModel)]="this.ipsrGeneralInformationBody.poverty_impact_area_id">
    </app-pr-radio-button>
  }

  @if (!this.fieldsManagerSE.isP25()) {
    <div *ngIf="this.ipsrGeneralInformationBody.poverty_tag_level_id != null">
      <app-pr-input
        label="Evidence"
        [required]="this.ipsrGeneralInformationBody.poverty_tag_level_id == 3"
        placeholder="Link"
        [(ngModel)]="this.ipsrGeneralInformationBody.evidence_poverty_tag">
      </app-pr-input>
    </div>
  }
</div>

@if (this.fieldsManagerSE.isP22()) {
  <app-pr-yes-or-not
    label="Is this result featured in a Key Result Story for the reporting year?"
    (ngModelChange)="onChangeKrs()"
    [(ngModel)]="this.ipsrGeneralInformationBody.is_krs"></app-pr-yes-or-not>
  <app-pr-input
    *ngIf="this.ipsrGeneralInformationBody.is_krs"
    placeholder="e.g. https://www.cgiar.org/example"
    type="text"
    [required]="false"
    [(ngModel)]="this.ipsrGeneralInformationBody.krs_url">
  </app-pr-input>
}
<app-save-button
  class="position_sticky"
  (clickSave)="onSaveSection()"
  [editable]="this.api.rolesSE.access.canDdit && !this.api.dataControlSE?.currentResult?.status">
</app-save-button>
